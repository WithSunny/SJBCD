This code draws on the idea of the code of this link: https://github.com/zqhZY/semanaly

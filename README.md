This code draws on the idea of the code of this link code: https://github.com/zqhZY/semanaly